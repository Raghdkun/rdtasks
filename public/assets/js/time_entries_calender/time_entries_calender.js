$(document).ready((function(){"use strict";$("#editTimeUserId, #editTimeProjectId, #editTaskId, #editActivityTypeId").select2({width:"100%"}),$("#calendarFilterUser").select2();var e=$("#calendar").fullCalendar({height:750,header:{left:"prev,next today",center:"title",right:"agendaWeek,agendaDay"},buttonText:{today:"Today",week:"Week",day:"Day"},defaultDate:new Date,defaultView:"agendaWeek",editable:!1,allDaySlot:!1,eventRender:function(e,a){var t="Duration - "+roundToQuarterHourAllForCalendarView(e.time_duration);a.find(".fc-title").append("<br>"+t)},eventAfterRender:function(e,a){$(a).tooltip({title:e.user,container:"body"})},timeFormat:"h:mm A",eventAfterAllRender:function(e){setTimeout((function(){$("#calendar button.fc-today-button").removeClass("disabled").prop("disabled",!1)}),100)},eventClick:function(e){renderTimeEntry(e.id)}}),a=moment().startOf("week").format(),t=moment().endOf("week").format(),n=$("#calendarFilterUser").val();$(document).ready((function(){$("#calendarFilterUser").val(loginUserId).trigger("change"),loginUserAdmin||(n=loginUserId,getWeekDataForCalendar(a,t,loginUserId))})),$(document).on("change","#calendarFilterUser",(function(){n=$(this).val(),screenLock(),getWeekDataForCalendar(a,t,n)})),$(document).on("click","button.fc-prev-button",(function(){screenLock(),a=$("#calendar").fullCalendar("getView").start.format(),t=$("#calendar").fullCalendar("getView").end.format(),getWeekDataForCalendar(a,t,n)})),$(document).on("click","button.fc-next-button",(function(){screenLock(),a=$("#calendar").fullCalendar("getView").start.format(),t=$("#calendar").fullCalendar("getView").end.format(),getWeekDataForCalendar(a,t,n)})),e.find(".fc-today-button").click((function(){a=$("#calendar").fullCalendar("getView").start.format(),t=moment().endOf("day").format(),getWeekDataForCalendar(a,t,n)})),e.find(".fc-agendaDay-button").click((function(){a=$("#calendar").fullCalendar("getView").start.format(),getWeekDataForCalendar(a,a,n)})),e.find(".fc-agendaWeek-button").click((function(){a=$("#calendar").fullCalendar("getView").start.format(),t=$("#calendar").fullCalendar("getView").end.format();var e=new Date(t);e.setDate(e.getDate()-1),t=e.toISOString(),getWeekDataForCalendar(a,t,n)})),window.getWeekDataForCalendar=function(e,a,t){$.ajax({url:route("time-entries-calendar-list"),type:"GET",dataType:"json",data:{start_date:e,end_date:a,userId:t},success:function(e){if(screenUnLock(),e.success){var a=0;$.each(e.data,(function(e,t){a+=t.totalDuration})),$("#calendar").fullCalendar("removeEvents"),$("#calendar").fullCalendar("addEventSource",e.data),$("#calendar").fullCalendar("rerenderEvents"),$(".totalTimeEntryHours").remove(),$(".fc-center").append('<div class="totalTimeEntryHours badge badge-primary">'+timeLogged+" = "+roundToQuarterHourAllForCalendarView(a)+"</div>")}},error:function(e){manageAjaxErrors(e)}})},window.onscroll=function(){$(".tooltip").hide()}}));