(()=>{"use strict";$((function(){$("#projectId,#editProjectId").select2({width:"100%",placeholder:"Select Projects"}),$("#roleId,#editRoleId").select2({width:"100%",placeholder:"Select Role"}),$("#filterStatus").select2({width:"100%"})})),$(document).ready((function(){$("input").attr("autocomplete","false")}));var e=$("#users_table").DataTable({processing:!0,serverSide:!0,order:[[0,"asc"]],ajax:{url:route("users.index")},columnDefs:[{targets:[6],orderable:!1,className:"text-center",width:"5%"},{targets:[5],orderable:!1,className:"text-center",width:"5%"},{targets:[4],className:"text-center",width:"4%"},{targets:[3,7],orderable:!1,className:"text-center",width:"6%"}],columns:[{data:"name",name:"name"},{data:"email",name:"email"},{data:"phone",name:"phone"},{data:"role_name",name:"role_name",searchable:!1},{data:"salary",name:"salary"},{data:function(e){var t=0===e.is_active?"":"checked";return loggedInUserId===e.id?"":' <label class="switch switch-label switch-outline-primary-alt"><input name="is_active" data-id="'+e.id+'" class="switch-input is-active" type="checkbox" value="1" '+t+'><span class="switch-slider" data-checked="&#x2713;" data-unchecked="&#x2715;"></span></label>'},name:"id"},{data:function(e){var t='<button type="button" title="Send Verification Mail" id="email-btn" class="btn action-btn btn-primary btn-sm email-btn" data-loading-text="<span class=\'spinner-border spinner-border-sm\'></span>" data-id="'+e.id+'"><i class="icon-envelope icons action-icon"></i></button>';return e.is_email_verified&&(t='<a title="Email Verified" data-id="'+e.id+'"><i class="cui-circle-check check-icon"></i></a>'),t},name:"id"},{data:function(e){return'<a title="Edit" class="btn action-btn btn-primary btn-sm edit-btn mr-1" data-id="'+e.id+'"><i class="cui-pencil action-icon user-js-action-color"></i></a><a title="Delete" class="btn action-btn btn-danger btn-sm delete-btn" data-id="'+e.id+'"><i class="cui-trash action-icon text-danger"></i></a>'},name:"id"}]});$("#users_table").on("draw.dt",(function(){$('[data-toggle="tooltip"]').tooltip()})),window.renderData=function(e){$.ajax({url:route("users.edit",e),type:"GET",success:function(e){if(e.success){var t=e.data,a=document.createElement("textarea");a.innerHTML=t.name,$("#userId").val(t.id),$("#edit_name").val(a.value),$("#edit_email").val(t.email),$("#edit_phone").val(t.phone),$("#edit_salary").val(t.salary),$(".price-input").trigger("input"),$("#editProjectId").val(t.project_ids).trigger("change"),t.is_active&&$("#edit_is_active").val(1).prop("checked",!0),t.email_verified_at?$("#edit_email_verified_at").val(1).prop("checked",!0).attr("disabled",!0):$("#edit_email_verified_at").attr("disabled",!1),$("#edit_email_verified_at").trigger("change"),$("#editRoleId").val(t.role_id).trigger("change"),isEmpty(t.img_avatar)?$("#editPreviewImage").attr("src",defaultImageUrl):$("#editPreviewImage").attr("src",t.img_avatar),$("#EditModal").modal("show")}},error:function(e){manageAjaxErrors(e)}})},window.sendVerificationEmail=function(e){$.ajax({url:route("send-email",e),type:"GET",beforeSend:function(){startLoader()},success:function(e){e.success&&swal("Success!",e.message,"success")},error:function(e){manageAjaxErrors(e)},complete:function(){stopLoader(),$(".email-btn").html('<i class="fas fa-sync font-size-12px"></i>')}})},$("#new_password, #new_confirm_password").on("keypress",(function(e){if(32==e.which)return!1})),$((function(){$(document).on("submit","#addNewForm",(function(e){e.preventDefault();var t=jQuery(this).find("#btnSave");t.button("loading"),$.ajax({url:route("users.store"),type:"POST",data:new FormData($(this)[0]),processData:!1,contentType:!1,success:function(e){e.success&&(displaySuccessMessage(e.message),$("#AddModal").modal("hide"),$("#users_table").DataTable().ajax.reload(null,!1),window.livewire.emit("refresh"))},error:function(e){printErrorMessage("#validationErrorsBox",e)},complete:function(){t.button("reset")}})})),$(document).on("submit","#editForm",(function(e){e.preventDefault(),$("#edit_email_verified_at").attr("disabled",!1);var t=jQuery(this).find("#btnEditSave");t.button("loading");var a=$("#userId").val();$.ajax({url:route("users-update",a),type:"POST",data:new FormData($(this)[0]),processData:!1,contentType:!1,success:function(e){e.success&&(displaySuccessMessage(e.message),$("#EditModal").modal("hide"),$("#users_table").DataTable().ajax.reload(null,!1),"/users"==window.location.pathname&&window.livewire.emit("refresh"))},error:function(e){manageAjaxErrors(e),$("#edit_email_verified_at").attr("disabled",!0)},complete:function(){t.button("reset")}})})),$("#AddModal").on("hidden.bs.modal",(function(){$("#projectId").val(null).trigger("change"),$("#roleId").val(null).trigger("change"),$("#previewImage").attr("src",defaultImageUrl),resetModalForm("#addNewForm","#validationErrorsBox")})),$("#EditModal").on("hidden.bs.modal",(function(){resetModalForm("#editForm","#editValidationErrorsBox")})),$(document).on("click",".edit-btn",(function(e){var t=$(e.currentTarget).attr("data-id");renderData(t)})),$(document).on("click",".delete-btn",(function(e){var t=$(e.currentTarget).attr("data-id"),a='<div class="alert alert-warning swal__alert">\n<strong class="swal__text-warning">'+deleteMessage+" "+user+'?</strong><div class="swal__text-message">'+deleteUserConfirm+"</div></div>";setTimeout((function(){revokerTracker()}),1e3),swal({type:"input",inputPlaceholder:deleteConfirm+' "'+deleteWord+'" '+toTypeDelete+" User.",title:deleteHeading+" !",text:a,html:!0,showCancelButton:!0,closeOnConfirm:!1,showLoaderOnConfirm:!0,confirmButtonColor:"#6777ef",cancelButtonColor:"#d33",cancelButtonText:noMessages,confirmButtonText:yesMessages,imageUrl:baseUrl+"images/warning.png"},(function(e){return!1!==e&&(""==e||"delete"!=e.toLowerCase()?(swal.showInputError('Please type "delete" to delete this client.'),$(".sa-input-error").css("top","23px!important"),$(document).find(".sweet-alert.show-input :input").val(""),!1):void("delete"===e.toLowerCase()&&$.ajax({url:route("users.destroy",t),type:"DELETE",dataType:"json",success:function(e){e.success&&window.livewire.emit("refresh"),swal({title:"Deleted!",text:"User has been deleted.",confirmButtonColor:"#6777ef",type:"success",timer:2e3})},error:function(e){swal({title:"",text:e.responseJSON.message,confirmButtonColor:"#6777ef",type:"error",timer:5e3})}})))}))})),$(document).on("click",".email-btn",(function(e){$(this).html('<i class="fas fa-sync font-size-12px fa-spin"></i>');var t=$(e.currentTarget).attr("data-id");sendVerificationEmail(t)}))})),$(document).on("change",".is-active",(function(e){var t=$(e.currentTarget).attr("data-id");activeDeActiveUser(t)})),window.activeDeActiveUser=function(t){$.ajax({url:route("active-de-active-user",t),method:"post",cache:!1,success:function(t){t.success&&(displaySuccessMessage(t.message),e.ajax.reload(),window.livewire.emit("refresh"))},error:function(e){manageAjaxErrors(e),setTimeout(location.reload(!0),700)}})},$(".modal").on("show.bs.modal",(function(){$(this).appendTo("body")})),$(document).on("change","#userProfile",(function(){var e=$(this).val().split(".").pop().toLowerCase();-1==$.inArray(e,["png","jpg","jpeg"])?($(this).val(""),$("#validationErrorsBox").html("The profile image must be a file of type: jpeg, jpg, png.").show(),setTimeout((function(){$("#validationErrorsBox").slideUp()}),5e3)):displayPhoto(this,"#previewImage")})),$(document).on("change","#userEditProfile",(function(){var e=$(this).val().split(".").pop().toLowerCase();-1==$.inArray(e,["png","jpg","jpeg"])?($(this).val(""),$("#editValidationErrorsBox").html("The profile image must be a file of type: jpeg, jpg, png.").show(),setTimeout((function(){$("#editValidationErrorsBox").slideUp()}),5e3)):displayPhoto(this,"#editPreviewImage")})),$(document).on("change","#filterStatus",(function(){window.livewire.emit("filterUsers",$(this).val())})),$(document).on("click",".permanent-delete",(function(e){var t=$(e.currentTarget).attr("data-id");swal({title:deleteHeading+" !",text:'Are you sure  want to delete this "User" ?',type:"warning",showCancelButton:!0,closeOnConfirm:!1,showLoaderOnConfirm:!0,confirmButtonColor:"#6777ef",cancelButtonColor:"#d33",cancelButtonText:noMessages,confirmButtonText:yesMessages},(function(){$.ajax({url:"users/"+t+"/delete",type:"DELETE",dataType:"json",success:function(e){e.success&&window.livewire.emit("refresh"),swal({title:"Deleted!",text:"User has been deleted.",confirmButtonColor:"#6777ef",type:"success",timer:2e3})},error:function(e){swal({title:"",text:e.responseJSON.message,confirmButtonColor:"#6777ef",type:"error",timer:5e3})}})}))})),$(document).on("click",".restore-btn",(function(e){var t=$(e.currentTarget).attr("data-id");swal({title:"Restore !",text:"Are you sure  want to restore this User ?",type:"info",showCancelButton:!0,closeOnConfirm:!1,showLoaderOnConfirm:!0,confirmButtonColor:"#5cb85c",cancelButtonColor:"#d33",cancelButtonText:noMessages,confirmButtonText:yesMessages},(function(){$.ajax({url:"users/"+t+"/restore",type:"POST",dataType:"json",success:function(e){e.success&&window.livewire.emit("refresh"),swal({title:"Restored!",text:"User has been restored.",type:"success",timer:2e3})},error:function(e){swal({title:"",text:e.responseJSON.message,type:"error",timer:5e3})}})}))}))})();