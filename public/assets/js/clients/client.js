$(document).ready((function(){"use strict";$("#department_id,#edit_department_id").select2({width:canManageDepartment?"calc(100% - 44px)":"100%",placeholder:"Select Department"}),$("#filter_department").select2(),$("#AddModal").on("show.bs.modal",(function(){$(this).find("#password").slideUp()})),$("#EditModal").on("shown.bs.modal",(function(){$(this).find("#new_edit_password").val("")})),$(document).on("click","#addClient",(function(){var e=$("#AddModal");$(this).prop("checked")?(e.find("#password").slideDown(),e.find("#new_password").attr("required",!0),e.find("#new_confirm_password").attr("required",!0)):(e.find("#password").slideUp(),e.find("#new_password").removeAttr("required"),e.find("#new_password").val(""),e.find("#new_confirm_password").removeAttr("required"),e.find("#new_confirm_password").val(""))})),$("#new_password, #new_confirm_password, #new_edit_password, #new_confirm_edit_password").on("keypress",(function(e){if(32==e.which)return!1})),$(document).on("submit","#addNewForm",(function(e){e.preventDefault();var t=jQuery(this).find("#btnSave");t.button("loading"),0==$("#addClient").prop("checked")&&""!=$("#new_password").val()&&$("#new_password").val(""),$.ajax({url:route("clients.store"),type:"POST",data:new FormData($(this)[0]),processData:!1,contentType:!1,success:function(e){e.success&&(displaySuccessMessage(e.message),$("#AddModal").modal("hide"),$("#clients_table").DataTable().ajax.reload(null,!1),window.livewire.emit("refresh"))},error:function(e){printErrorMessage("#validationErrorsBox",e)},complete:function(){t.button("reset")}})})),$(document).on("submit","#addNewDepartment",(function(e){e.preventDefault();var t=jQuery(this).find("#btnDepartmentSave");t.button("loading");var a=$(this).serializeArray();$.ajax({url:"departments",type:"POST",data:a,success:function(e){if($("#department_id, #edit_department_id").empty(),e.success){displaySuccessMessage(e.message);var t="<option value=''>Select Department</option>";$.each(e.data.departments,(function(e,a){t+="<option value='"+a+"'>"+e+"</option>",$("#department_id, #edit_department_id").html(t)})),$("#AddModal").hasClass("show")?$("#department_id").val(e.data.department.id).trigger("change.select2"):$("#EditModal").hasClass("show")&&$("#edit_department_id").val(e.data.department.id).trigger("change.select2"),$("#addDepartmentModal").modal("hide")}},error:function(e){printErrorMessage("#departmentValidationErrorsBox",e)},complete:function(){t.button("reset")}})})),$(document).on("submit","#editForm",(function(e){e.preventDefault();var t=jQuery(this).find("#btnEditSave");t.button("loading");var a=$("#clientId").val();$.ajax({url:route("clients-update",a),type:"POST",data:new FormData($(this)[0]),processData:!1,contentType:!1,success:function(e){e.success&&(displaySuccessMessage(e.message),$("#EditModal").modal("hide"),$("#clients_table").DataTable().ajax.reload(null,!1),window.livewire.emit("refresh"))},error:function(e){manageAjaxErrors(e)},complete:function(){t.button("reset")}})})),$("#addDepartmentModal").on("hidden.bs.modal",(function(){resetModalForm("#addNewDepartment","#validationErrorsBox")})),$("#AddModal").on("hidden.bs.modal",(function(){resetModalForm("#addNewForm","#validationErrorsBox"),$("#previewImage").attr("src",defaultImageUrl),$("#department_id").val("").trigger("change.select2")})),$("#EditModal").on("hidden.bs.modal",(function(){$("#delete-warning").empty(),resetModalForm("#editForm","#editValidationErrorsBox")})),window.renderData=function(e){$.ajax({url:route("clients.edit",e),type:"GET",success:function(e){if(e.success){var t=e.data,a=document.createElement("textarea");a.innerHTML=t.name,$("#clientId").val(t.id),$("#edit_name").val(a.value),$("#edit_email").val(t.email),$("#edit_department_id").val(t.department_id).trigger("change.select2"),$("#edit_website").val(t.website),isEmpty(t.avatar)?$("#editPreviewImage").attr("src",defaultImageUrl):$("#editPreviewImage").attr("src",t.avatar),t.email&&null!=t.user_id&&$("#delete-warning").append("(If you save this record without email all records of this client will be deleted)"),$("#EditModal").modal("show")}},error:function(e){manageAjaxErrors(e)}})},$(document).on("click",".edit-btn",(function(e){var t=$(e.currentTarget).attr("data-id");renderData(t)})),$(document).on("click",".delete-btn",(function(e){var t=$(e.currentTarget).attr("data-id"),a='<div class="alert alert-warning swal__alert">\n<strong class="swal__text-warning">'+deleteClientConfirm+'</strong><div class="swal__text-message">'+byDeleteThisClient+"</div></div>";deleteItemInputConfirmation(route("clients.destroy",t),"#clients_table","Client",a)})),$(".modal").on("show.bs.modal",(function(){$(this).appendTo("body")})),$(document).on("change","#filter_department",(function(){window.livewire.emit("filterDepartment",$(this).val())})),$(document).on("change","#clientProfile",(function(){var e=$(this).val().split(".").pop().toLowerCase();-1==$.inArray(e,["png","jpg","jpeg"])?($(this).val(""),$("#validationErrorsBox").html("The profile image must be a file of type: jpeg, jpg, png.").show(),setTimeout((function(){$("#validationErrorsBox").slideUp()}),5e3)):displayPhoto(this,"#previewImage")})),$(document).on("change","#clientEditProfile",(function(){var e=$(this).val().split(".").pop().toLowerCase();-1==$.inArray(e,["png","jpg","jpeg"])?($(this).val(""),$("#editValidationErrorsBox").html("The profile image must be a file of type: jpeg, jpg, png.").show(),setTimeout((function(){$("#editValidationErrorsBox").slideUp()}),5e3)):displayPhoto(this,"#editPreviewImage")})),$(document).on("click",".show-btn",(function(e){var t=$(e.currentTarget).attr("data-id");$.ajax({url:route("clients.show",t),type:"GET",success:function(e){if(e.success){$("#showImage").show(),$("#showName").html(""),$("#showDepartment").html(""),$("#showEmail").html(""),$("#showWebsite").html(""),$(".progressProjectFinished").html(""),$(".progressProjectInProgress").html(""),$(".progressProjectHold").html(""),$(".progressProjectArchived").html(""),$("#showName").append(e.data.name),$("#showDepartment").append(e.data.department.name),isEmpty(e.data.email)?$("#showEmail").append("N/A"):$("#showEmail").append(e.data.email),isEmpty(e.data.website)?$("#showWebsite").append("N/A"):$("#showWebsite").append(e.data.website),isEmpty(e.data.media)?($("#noImage").hide(),$("#showImage").attr("src",defaultImageUrl)):($("#showImage").attr("src",e.data.avatar),$("#noImage").hide()),$(".progressProjectFinished").append(e.data.project_progress.completedProjects),$(".progressProjectInProgress").append(e.data.project_progress.openProjects),$(".progressProjectHold").append(e.data.project_progress.holdProjects),$(".progressProjectArchived").append(e.data.project_progress.archivedProjects),$("#progressProjectFinished").css("width","100%"),$("#progressProjectInProgress").css("width","100%"),$("#progressProjectHold").css("width","100%"),$("#progressProjectArchived").css("width","100%");var t=document.createElement("textarea");t.innerHTML=isEmpty(e.data.description)?"N/A":e.data.description,$("#showDescription").append(t.value),$("#showModal").appendTo("body").modal("show")}},error:function(e){displayErrorMessage(e.responseJSON.message)}})})),$(document).on("blur","#website",(function(){var e=$(this).val();isEmpty(e)||(e=websiteURLConvert(e),$("#website").val(e))})),$(document).on("blur","#edit_website",(function(){var e=$(this).val();isEmpty(e)?$("#edit_website").val(""):(e=websiteURLConvert(e),$("#edit_website").val(e))})),window.websiteURLConvert=function(e){return~e.indexOf("http")||(e="http://"+e),e}}));