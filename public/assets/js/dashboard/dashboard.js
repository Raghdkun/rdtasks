(()=>{"use strict";var e;function a(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}$(document).ready((function(){$("#userId").select2({width:"100%",placeholder:"Select User"})}));var t=$("#time_range"),s="ar"==languageName?moment().lang("en"):moment(),n=s.clone().startOf("month"),o=s.clone().endOf("month"),r=$("#userId").val(),m=!1;$(window).on("load",(function(){"ar"==languageName?(loadUserWorkReport(n.lang("en").format("YYYY-MM-D  H:mm:ss"),o.lang("en").format("YYYY-MM-D  H:mm:ss"),r),loadHours(n.lang("en").format("YYYY-MM-D  H:mm:ss"),o.lang("en").format("YYYY-MM-D  H:mm:ss"),r)):(loadUserWorkReport(n.format("YYYY-MM-D  H:mm:ss"),o.format("YYYY-MM-D  H:mm:ss"),r),loadHours(n.format("YYYY-MM-D  H:mm:ss"),o.format("YYYY-MM-D  H:mm:ss"),r))})),t.on("apply.daterangepicker",(function(e,a){m=!0,n="ar"==languageName?a.startDate.lang("en").format("YYYY-MM-D  H:mm:ss"):a.startDate.format("YYYY-MM-D  H:mm:ss"),o="ar"==languageName?a.endDate.lang("en").format("YYYY-MM-D  H:mm:ss"):a.endDate.format("YYYY-MM-D  H:mm:ss"),loadUserWorkReport(n,o,r),loadHours(n,o,r)})),window.cb=function(e,a){"ar"==languageName?t.find("span").html(e.lang("en").format("MMM D, YYYY")+" - "+a.lang("en").format("MMM D, YYYY")):t.find("span").html(e.format("MMM D, YYYY")+" - "+a.format("MMM D, YYYY"))},cb(n,o);var g=moment().startOf("month").subtract(1,"days");t.daterangepicker({startDate:n,endDate:o,opens:"left",showDropdowns:!0,autoUpdateInput:!1,locale:{customRangeLabel:Lang.get("messages.common.custom"),applyLabel:Lang.get("messages.common.apply"),cancelLabel:Lang.get("messages.common.cancel"),fromLabel:Lang.get("messages.common.from"),toLabel:Lang.get("messages.common.to"),monthNames:[Lang.get("messages.months.jan"),Lang.get("messages.months.feb"),Lang.get("messages.months.mar"),Lang.get("messages.months.apr"),Lang.get("messages.months.may"),Lang.get("messages.months.jun"),Lang.get("messages.months.jul"),Lang.get("messages.months.aug"),Lang.get("messages.months.sep"),Lang.get("messages.months.oct"),Lang.get("messages.months.nov"),Lang.get("messages.months.dec")],daysOfWeek:[Lang.get("messages.weekdays.sun"),Lang.get("messages.weekdays.mon"),Lang.get("messages.weekdays.tue"),Lang.get("messages.weekdays.wed"),Lang.get("messages.weekdays.thu"),Lang.get("messages.weekdays.fri"),Lang.get("messages.weekdays.sat")]},ranges:(e={},a(e,Lang.get("messages.days.today"),[moment(),moment()]),a(e,Lang.get("messages.days.this_week"),[moment().startOf("week"),moment().endOf("week")]),a(e,Lang.get("messages.days.last_week"),[moment().startOf("week").subtract(7,"days"),moment().startOf("week").subtract(1,"days")]),a(e,Lang.get("messages.days.this_month"),[n,o]),a(e,Lang.get("messages.days.last_month"),[g.clone().startOf("month"),g.clone().endOf("month")]),e)},cb),$("#userId").on("change",(function(e){e.preventDefault(),r=$("#userId").val();var a=m?n:n.format("YYYY-MM-D  H:mm:ss"),t=m?o:o.format("YYYY-MM-D  H:mm:ss");loadUserWorkReport(a,t,r),loadHours(a,t,r)})),window.loadHours=function(e,a,t){$.ajax({type:"GET",url:route("dashboard-total-hours"),dataType:"json",data:{start_date:e,end_date:a,user_id:t},cache:!1,success:function(e){$(".hours").empty(),$(".hours").append("("+e.data+")")}})},window.loadUserWorkReport=function(e,a,t){$.ajax({type:"GET",url:route("users-work-report"),dataType:"json",data:{start_date:e,end_date:a,user_id:t},cache:!1}).done(prepareUserWorkReport)},window.prepareUserWorkReport=function(e){$("#daily-work-report").html("");var a=e.data;if(0===a.totalRecords)return $("#work-report-container").html(""),$("#work-report-container").append('<div align="center" class="no-record">'+noRecordFoundMessage+"</div>"),!0;$("#work-report-container").html(""),$("#work-report-container").append('<canvas id="daily-work-report"></canvas>');var t={labels:a.date,datasets:a.data,total_hrs:a.totalHrs},s=document.getElementById("daily-work-report").getContext("2d");s.canvas.style.height="400px",s.canvas.style.width="100%",window.myBar=new Chart(s,{type:"bar",data:t,options:{title:{display:!1,text:a.label},tooltips:{mode:"index",callbacks:{title:function(e,a){var t=e[0].label;return t+" - "+roundToQuarterHour(a.total_hrs[t])},label:function(e,a){var t=roundToQuarterHour(e.yLabel);if("0min"===t)return"";var s=document.createElement("textarea");s.innerHTML=a.datasets[e.datasetIndex].label;var n=s.value||"";return n&&(n+=": "),n+t}}},responsive:!1,maintainAspectRatio:!1,scales:{xAxes:[{stacked:!0}],yAxes:[{stacked:!0,scaleLabel:{display:!0,labelString:"Hours"},ticks:{min:0,stepSize:1}}]}}})},window.roundToQuarterHour=function(e){var a=e.toString().split("."),t=parseInt(a[0]),s=Math.floor(60*e)-Math.floor(60*t);return 0===t?s+"min":s>0?t+"hr "+s+"min":t+"hr"},$(document).ready((function(){var e=$(".range_inputs > button.applyBtn");$(document).on("click",".ranges li",(function(){"Custom Range"===$(this).data("range-key")?e.css("display","initial"):e.css("display","none")})),e.css("display","none")}))})();