(()=>{"use strict";var e=Pickr.create({el:".color-wrapper",theme:"nano",closeWithKey:"Enter",autoReposition:!0,defaultRepresentation:"HEX",swatches:["rgba(244, 67, 54, 1)","rgba(233, 30, 99, 1)","rgba(156, 39, 176, 1)","rgba(103, 58, 183, 1)","rgba(63, 81, 181, 1)","rgba(33, 150, 243, 1)","rgba(3, 169, 244, 1)","rgba(0, 188, 212, 1)","rgba(0, 150, 136, 1)","rgba(76, 175, 80, 1)","rgba(139, 195, 74, 1)","rgba(205, 220, 57, 1)","rgba(255, 235, 59, 1)","rgba(255, 193, 7, 1)"],components:{preview:!0,hue:!0,interaction:{input:!0,clear:!1,save:!1}}}),t=Pickr.create({el:".color-wrapper",theme:"nano",closeWithKey:"Enter",autoReposition:!0,defaultRepresentation:"HEX",swatches:["rgba(244, 67, 54, 1)","rgba(233, 30, 99, 1)","rgba(156, 39, 176, 1)","rgba(103, 58, 183, 1)","rgba(63, 81, 181, 1)","rgba(33, 150, 243, 1)","rgba(3, 169, 244, 1)","rgba(0, 188, 212, 1)","rgba(0, 150, 136, 1)","rgba(76, 175, 80, 1)","rgba(139, 195, 74, 1)","rgba(205, 220, 57, 1)","rgba(255, 235, 59, 1)","rgba(255, 193, 7, 1)"],components:{preview:!0,hue:!0,interaction:{input:!0,clear:!1,save:!1}}});e.on("change",(function(){var t=e.getColor().toHEXA().toString();if(wc_hex_is_light(t))return $("#validationErrorsBox").text(""),$("#validationErrorsBox").show().html(""),$("#validationErrorsBox").text("Pick a different color"),setTimeout((function(){$("#validationErrorsBox").slideUp()}),5e3),void $(':input[id="btnSave"]').prop("disabled",!0);$(':input[id="btnSave"]').prop("disabled",!1),e.setColor(t),$("#color").val(t)})),t.on("change",(function(){var e=t.getColor().toHEXA().toString();if(wc_hex_is_light(e))return $(".editValidationErrorsBox").text(""),$(".editValidationErrorsBox").show().html(""),$(".editValidationErrorsBox").text("Pick a different color"),setTimeout((function(){$(".editValidationErrorsBox").slideUp()}),5e3),void $(':input[id="btnEditSave"]').prop("disabled",!0);$(':input[id="btnEditSave"]').prop("disabled",!1),t.setColor(e),$("#edit_color").val(e)})),$(document).ready((function(){$("#client_id,#edit_client_id").select2({width:canManageClients?"calc(100% - 44px)":"100%",placeholder:"Select Client"}),$("#budget_type,#edit_budget_type,#editStatusProject,#projectStatus").select2({width:"100%"}),$("#filterClient").select2(),$("#currency,#editCurrency").select2({width:"100%"}),$("#user_ids,#edit_user_ids").select2({width:"100%",placeholder:"Select Users"}),$("#editProjectUser").select2({width:"100%"}),$("#department_id,#edit_department_id").select2({width:"100%",placeholder:"Select Department"})})),$(document).on("click",".edit-project-assignees",(function(e){var t=$(this).attr("data-id");startLoader(),$.ajax({url:route("projects.edit",t),type:"GET",success:function(e){if(e.success){var t=e.data.project.id,r=e.data.project.allUsers;$.each(r,(function(e,t){$("#editProjectUser").append($("<option>",{value:t,text:t.name}))})),$("#hdnProjectId").val(t);var i=e.data.users;$("#editProjectUser").val(i).trigger("change"),$("#editProjectUser").val(e.data.users).trigger("change"),stopLoader(),$("#assignProjectUserModal").appendTo("body").modal("show")}},error:function(e){manageAjaxErrors(e)}})})),$(document).on("click","#btnSaveAssigneesProject",(function(){jQuery(this).button("loading"),window.livewire.emit("updateAssigneesProject",$("#editProjectUser").val(),$("#hdnProjectId").val()),$("#assignProjectUserModal").modal("hide"),displaySuccessMessage("Project assignee updated successfully")})),$("#assignProjectUserModal").on("hidden.bs.modal",(function(){$("#editProjectUser").val(null).trigger("change"),jQuery("#btnSaveAssigneesProject").button("reset")})),$("#description,#editDescription").summernote({placeholder:"Add Project description...",minHeight:200,toolbar:[["style",["bold","italic","underline","clear"]],["font",["strikethrough"]],["para",["paragraph"]]]});var r=$("#projects_table").DataTable({processing:!0,serverSide:!0,order:[[0,"asc"]],ajax:{url:route("projects.index"),data:function(e){e.filter_client=$("#filterClient").find("option:selected").val()}},columnDefs:[{targets:[0],className:"text-center",width:"7%"},{targets:[3],orderable:!1,className:"text-center",width:"5%"}],columns:[{data:"prefix",name:"prefix"},{data:"name",name:"name"},{data:"client.name",defaultContent:"",name:"client.name"},{data:function(e){return'<a title="Edit" class="btn action-btn btn-primary btn-sm edit-btn mr-1" data-id="'+e.id+'"><i class="cui-pencil action-icon"></i></a><a title="Delete" class="btn action-btn btn-danger btn-sm delete-btn" data-id="'+e.id+'"><i class="cui-trash action-icon" ></i></a>'},name:"id"}],fnInitComplete:function(){$(document).on("change","#filterClient",(function(){r.ajax.reload()}))}});$(document).on("submit","#color",(function(){!0})),$("#AddModal").on("show.bs.modal",(function(e){$(".pcr-button").css({color:"#3F51B5",border:"1px solid grey"})})),$(document).on("submit","#addNewForm",(function(e){e.preventDefault();$("<div />").html($("#description").summernote("code")).text().trim().replace(/ \r\n\t/g,"");var t=jQuery(this).find("#btnSave");if(t.button("loading"),""==$("#color").val())return displayErrorMessage("Please select your color."),t.button("reset"),!1;$(this);var r=$(this).serializeArray();r[r.length]={name:"color",value:$("#color").val()},$.ajax({url:route("projects.store"),type:"POST",data:r,success:function(e){e.success&&(displaySuccessMessage(e.message),$("#AddModal").modal("hide"),$("#projects_table").DataTable().ajax.reload(null,!1),revokerTracker(),window.livewire.emit("refresh"))},error:function(e){printErrorMessage("#validationErrorsBox",e)},complete:function(){t.button("reset")}})})),$(document).on("submit","#editFormProject",(function(e){e.preventDefault();var t=""===$("<div />").html($("#editDescription").summernote("code")).text().trim().replace(/ \r\n\t/g,"");if(0==$("#editPrice").val())return displayErrorMessage("The budget amount should be a minimum of 1."),!1;if(removeCommas($("#editPrice").val()).length>12)return displayErrorMessage("Maximum 12 digits budget amount is allowed."),!1;$(this);var r=jQuery(this).find("#btnEditSave");if(r.button("loading"),$("#editDescription").summernote("isEmpty"))$("#editDescription").summernote("code");else if(t)return displayErrorMessage("Description field is not contain only white space"),r.button("reset"),!1;var i=$(this).serializeArray();i[i.length]={name:"color",value:$("#edit_color").val()};var a=$("#projectId").val();$.ajax({url:route("projects.update",a),type:"put",data:i,success:function(e){e.success&&(displaySuccessMessage(e.message),$("#ProjectEditModal").modal("hide"),$("#projects_table").DataTable().ajax.reload(null,!1),revokerTracker(),window.livewire.emit("refresh"))},error:function(e){displayErrorMessage(e.responseJSON.message)},complete:function(){r.button("reset")}})})),$(document).on("submit","#addNewClientForm",(function(e){e.preventDefault();var t=jQuery(this).find("#btnClientSave");t.button("loading"),$.ajax({url:"/client/store",type:"POST",data:$(this).serializeArray(),success:function(e){if($("#client_id").empty(),e.success){displaySuccessMessage(e.message);var t="<option value=''>Select Client</option>";$.each(e.data.clients,(function(e,r){t+="<option value='"+e+"'>"+r+"</option>",$("#client_id, #edit_client_id").html(t)})),$("#AddModal").hasClass("show")?$("#client_id").val(e.data.client.id).trigger("change.select2"):$("#ProjectEditModal").hasClass("show")&&$("#edit_client_id").val(e.data.client.id).trigger("change.select2"),$("#addClientModal").modal("hide")}},error:function(e){printErrorMessage("#clientValidationErrorsBox",e)},complete:function(){t.button("reset")}})})),$("#addClientModal").on("hidden.bs.modal",(function(){resetModalForm("#addNewClientForm","#clientValidationErrorsBox"),$("#department_id").val("").trigger("change.select2")})),$("#AddModal").on("hidden.bs.modal",(function(){$("#client_id").val(null).trigger("change"),$("#user_ids").val(null).trigger("change"),$("#currency").val(0).trigger("change"),$("#budget_type").val(null).trigger("change"),e.setColor("#42445A"),e.hide(),$("#description").summernote("code",""),resetModalForm("#addNewForm","#validationErrorsBox")})),$("#ProjectEditModal").on("show.bs.modal",(function(){$(".pcr-button").css("border","1px solid grey"),$(".project_remaining_user").popover("hide")})),$("#ProjectEditModal").on("hidden.bs.modal",(function(){$("#editDescription").summernote("code",""),t.hide(),resetModalForm("#editFormProject","#editValidationErrorsBox")})),window.renderData=function(e){$.ajax({url:route("projects.edit",e),type:"GET",success:function(e){if(e.success){var r=e.data.project,i=document.createElement("textarea");i.innerHTML=r.name,$("#projectId").val(r.id),$("#edit_name").val(i.value),$("#edit_prefix").val(r.prefix),t.setColor(r.color),$("#edit_client_id").val(r.client_id).trigger("change"),$("#editStatusProject").val(r.status).trigger("change"),$("#editDescription").summernote("code",r.description),isEmpty(r.price)||$("#editPrice").val(getFormattedPrice(r.price)),$("#editCurrency").val(r.currency).trigger("change"),$("#edit_budget_type").val(r.budget_type).trigger("change");var a=e.data.users;$("#edit_user_ids").val(a),$("#edit_user_ids").trigger("change"),$("#ProjectEditModal").modal("show")}},error:function(e){manageAjaxErrors(e)}})},$(document).on("click",".edit-btn",(function(e){var t=$(e.currentTarget).attr("data-id");renderData(t)})),$(document).on("click",".delete-btn",(function(e){var t=$(e.currentTarget).attr("data-id"),i='<div class="alert alert-warning swal__alert">\n<strong class="swal__text-warning">'+byDeleteThisProject+'</strong><div class="swal__text-message">'+deleteProjectConfirm+"</div></div>",a=getItemFromLocalStorage("project_id"),o=getItemFromLocalStorage("clockRunning");if(t===a&&"true"===o)return r.ajax.reload(),swal({title:"Warning",text:"Please stop timer before delete project.",type:"warning",confirmButtonColor:"#6777ef"}),!1;deleteItemInputConfirmation(route("projects.destroy",t),"#projects_table","Project",i),setTimeout((function(){revokerTracker()}),1e3)})),$(".modal").on("show.bs.modal",(function(){$(this).appendTo("body")})),$(document).on("change","#filterClient",(function(){window.livewire.emit("filterProjects",$(this).val())})),$(document).on("click","#all-projects",(function(){projectStatusLivewire(null)})),$("document").ready((function(){screenUnLock(),$("#statusOngoing").trigger("click")})),$(document).on("change","#projectStatus",(function(){var e=$(this).val();projectStatusLivewire(e)})),window.projectStatusLivewire=function(e){window.livewire.emit("projectsStatus",e)},$(document).on("change","#myProjects",(function(){var e=$(this).data("id");1==$("#myProjects").prop("checked")?window.livewire.emit("usersProject",e):window.livewire.emit("usersProject",null)})),document.addEventListener("livewire:load",(function(){window.livewire.hook("message.processed",(function(){$("#editProjectUser").select2({width:"100%"}),$("#projectStatus").select2({width:"100%"})}))})),$(document).on("focusout","#name",(function(e){var t=$(this).val();t=t.replace(/[^a-z0-9\s]/gi,"").replace(/[_\s]/g,""),$("#prefix").val(t.toUpperCase().slice(0,8))})),$(document).on("focusout","#prefix",(function(e){var t=$(this).val();t=t.replace(/[^a-z0-9\s]/gi,"").replace(/[_\s]/g,""),$(this).val(t.toUpperCase().slice(0,8))})),$(document).on("focusout","#edit_name",(function(e){var t=$(this).val();t=t.replace(/[^a-z0-9\s]/gi,"").replace(/[_\s]/g,""),$("#edit_prefix").val(t.toUpperCase().slice(0,8))})),$(document).on("focusout","#edit_prefix",(function(e){var t=$(this).val();t=t.replace(/[^a-z0-9\s]/gi,"").replace(/[_\s]/g,""),$(this).val(t.toUpperCase().slice(0,8))}))})();