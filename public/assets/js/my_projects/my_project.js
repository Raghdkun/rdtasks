(()=>{"use strict";$(document).ready((function(){$("#projectStatus").select2({width:"100%"})})),$(document).on("change","#projectStatus",(function(){var e=$(this).val();projectStatusLivewire(e)})),window.projectStatusLivewire=function(e){window.livewire.emit("projectsStatus",e)},document.addEventListener("livewire:load",(function(){window.livewire.hook("message.processed",(function(){$("#projectStatus").select2({width:"100%"})}))})),$("[data-toggle=popover]").popover({html:!0,content:function(){return $("#popover-content").html()}}),$((function(){$("#editAssignTo").select2({width:"100%",placeholder:"Select Assignee"}),$("#editProjectId").select2({width:"100%",placeholder:"Select Project"}),$("#editStatus").select2({width:"100%"}),$("#editAssignee").select2({width:"100%",placeholder:"Select Assignee"}),canManageTags?$("#editTagIds").select2({width:"100%",tags:!0,placeholder:"Select Tags",createTag:function(e){var t=!1;if($("#editTagIds option").each((function(){$.trim(e.term).toUpperCase()===$.trim($(this).text()).toUpperCase()&&(t=!0)})),!t)return{id:e.term,text:e.term}}}):$("#editTagIds").select2({width:"100%",placeholder:"Select Tags"}),$("#editPriority").select2({width:"100%",placeholder:"Select Priority"}),$("#dueDate,#editDueDate").datetimepicker({format:"YYYY-MM-DD",useCurrent:!1,locale:"ar"==languageName?"en":languageName,icons:{previous:"icon-arrow-left icons",next:"icon-arrow-right icons"},sideBySide:!0,minDate:moment().millisecond(0).second(0).minute(0).hour(0)}),$("#dueDate, #editDueDate").on("dp.show",(function(){matchWindowScreenPixels({dueDate:"#dueDate",editDueDate:"#editDueDate"},"tsk")})),$(window).resize((function(){matchWindowScreenPixels({dueDate:"#dueDate",editDueDate:"#editDueDate"},"tsk")})).trigger("resize"),$('[data-toggle="tooltip"]').tooltip()}));var e,t,i=$("#taskEditDescription").summernote({placeholder:"Add Task description...",minHeight:200,toolbar:[["style",["bold","italic","underline","clear"]],["font",["strikethrough"]],["para",["paragraph"]]]}),a=[];$(document).on("click",".edit-task-btn",(function(e){var t=$(e.currentTarget).attr("data-id");$.ajax({url:route("tasks.edit",t),type:"GET",success:function(e){if(e.success){var t=e.data.task,i=e.data.tags,o=document.createElement("textarea");$("#editTagIds").empty(),$.each(i,(function(e,t){o.innerHTML=t,$("#editTagIds").append($("<option>",{value:e,text:o.value}))}));t.description;var r=document.createElement("textarea");r.innerHTML=t.title,$("#tagId").val(t.id),$("#editTitle").val(r.value),$("#taskEditDescription").summernote("code",t.description),$("#editDueDate").val(t.due_date),$("#editProjectId").val(t.project.id).trigger("change"),$("#editStatus").val(t.status).trigger("change"),null==t.estimate_time_type&&null==t.estimate_time&&$("#editDays").removeClass("btn-primary text-white"),0==t.estimate_time_type||null==t.estimate_time?($("#editEstimateTimeDays").hide(),$("#editEstimateTimeHours").val(t.estimate_time).show(),$("#editHours").addClass("btn-primary text-white"),$("#editTypes").val(0)):($("#editEstimateTimeHours").hide(),$("#editEstimateTimeDays").val(t.estimate_time).show(),$("#editDays").addClass("btn-primary text-white"),$("#editTypes").val(1));var s=[],n=[];$(t.tags).each((function(e,t){s.push(t.id)})),$(t.task_assignee).each((function(e,t){n.push(t.id),a.push(t.id)})),$("#editTagIds").val(s).trigger("change"),$("#editAssignee").val(n).trigger("change"),$("#editPriority").val(t.priority).trigger("change"),setTimeout((function(){$.each(t.task_assignee,(function(e,t){$("#editAssignee option[value='"+t.id+"']").prop("selected",!0).trigger("change")})),$("#EditModal").appendTo("body").modal("show")}),1500)}},error:function(e){displayErrorMessage(e.responseJSON.message)}})})),$(document).on("change","#editProjectId",(function(e){!function(e,t){$("#"+t).empty(),$("#"+t).trigger("change"),$.ajax({url:route("users-of-projects")+"?projectIds="+e,type:"GET",success:function(e){var i=e.data;for(var a in i)i.hasOwnProperty(a)&&$("#"+t).append($("<option>",{value:a,text:i[a]}))}})}($(this).val(),"editAssignee")})),$(document).on("submit","#editForm",(function(e){e.preventDefault();var t=""===$("<div />").html($("#taskEditDescription").summernote("code")).text().trim().replace(/ \r\n\t/g,""),a=jQuery(this).find("#btnTaskEditSave");if(a.button("loading"),$("#taskEditDescription").summernote("isEmpty"))$("#taskEditDescription").val("");else if(t)return displayErrorMessage("Description field is not contain only white space"),a.button("reset"),!1;if(""==$("#editTitle").val().trim())return displayErrorMessage("Title field is not contain only white space"),a.button("reset"),!1;var o=$("#tagId").val(),r=getItemFromLocalStorage("task_id"),s=getItemFromLocalStorage("clockRunning");if(o===r&&"true"===s)return swal({title:"Warning",text:"Please stop timer before updating task.",type:"warning",confirmButtonColor:"#6777EF"}),a.button("reset"),!1;var n=$(this).serializeArray();i.summernote("code");$.ajax({url:route("tasks.update",o),type:"put",data:n,success:function(e){e.success&&($("#EditModal").modal("hide"),window.livewire.emit("refresh"),a.button("reset"),displaySuccessMessage("Task updated successfully."))},error:function(e){a.button("reset"),printErrorMessage("#editValidationErrorsBox",e)}})})),$("#EditModal").on("hidden.bs.modal",(function(){i.summernote("code",""),resetModalForm("#editForm","#editValidationErrorsBox")})),$(document).ready((function(){$('a[data-toggle="tab"]').on("shown.bs.tab",(function(e){localStorage.setItem("activeTab",$(e.target).attr("href"))}));var e=localStorage.getItem("activeTab");e&&($('.nav-tabs a[href="'+e+'"]').tab("show"),localStorage.removeItem("activeTab"))})),$((function(){$(document).on("change","input.complete-task-checkbox",(function(i){var a=$(this).attr("data-check");t=$(this);var o=getItemFromLocalStorage("task_id"),r=getItemFromLocalStorage("clockRunning");if(a===o&&"true"===r)return swal({title:"Warning",text:"Please stop timer before completing task.",type:"warning",confirmButtonColor:"#6777EF"}),t.prop("checked",!1),!1;""!=$("#filter_status").val()&&$(this).parentsUntil(".task-list").toggle("slide"),e(a)})),e=function(e){$.ajax({url:route("tasks.update-status",e),type:"PUT",cache:!1,data:{status:1},success:function(e){window.livewire.emit("refresh"),revokerTracker()}})}})),$(document).ready((function(){$("#editEstimateTimeHours").datetimepicker({format:"HH",useCurrent:!1,locale:"ar"==languageName?"en":languageName,icons:{previous:"icon-arrow-left icons",next:"icon-arrow-right icons",up:"icon-arrow-up icons",down:"icon-arrow-down icons"},sideBySide:!0}),$("#editEstimateTimeDays").hide(),$(document).on("click","#editHours",(function(){$("#editDays").removeClass("btn btn-primary text-white"),$(this).addClass("btn btn-primary text-white"),$("#editTypes").val(0),$("#editEstimateTimeDays").hide().val(""),$("#editEstimateTimeHours").show()})),$(document).on("click","#editDays",(function(){$("#editHours").removeClass("btn btn-primary text-white"),$(this).addClass("btn btn-primary text-white"),$("#editTypes").val(1),$("#editEstimateTimeHours").hide().val(""),$("#editEstimateTimeDays").show()})),$(document).on("click","#addTask",(function(e){e.preventDefault();var t=$(this).attr("data-id");$("#taskProjectId").val(t),$("#addTaskModal").appendTo("body").modal("show")}))}))})();